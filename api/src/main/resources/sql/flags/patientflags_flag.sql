REPLACE INTO `patientflags_flag` VALUES
(1,'No HIV Diagnosis Date','select distinct patient_id\r\nfrom patient p\r\nwhere (select value_datetime from obs where concept_id = 160554 and person_id = p.patient_id limit 1) is null and p.voided is null','Patient has no HIV Diagnosis date recorded',1,'org.openmrs.module.patientflags.evaluator.SQLFlagEvaluator',NULL,1,'2019-09-27 09:32:37',1,'2020-07-15 14:55:20',0,NULL,NULL,NULL,'19208809-c2e2-46f8-96a3-0b853988417d',1),
(2,'No HIV Enrollment Date','select distinct patient_id from patient p\r\nwhere (select encounter_datetime from encounter where encounter_type = 14 and patient_id = p.patient_id limit 1) is null and p.voided is null','Patient has no HIV Enrollment Date Recorded',1,'org.openmrs.module.patientflags.evaluator.SQLFlagEvaluator',NULL,1,'2019-09-27 09:34:24',1,'2020-07-15 14:55:29',0,NULL,NULL,NULL,'bde08bc9-e0da-41c3-aed2-d8948c5c3147',1),
(3,'No Address/LGA Documented','select p.patient_id, pd.address1,pd.city_village \r\nfrom patient p \r\njoin person_address pd on p.patient_id = pd.person_id  \r\nwhere pd.address1 is null and pd.city_village is null and p.voided is null','No Address/LGA Documented',1,'org.openmrs.module.patientflags.evaluator.SQLFlagEvaluator',NULL,1,'2019-09-27 09:43:08',1,'2019-10-11 09:59:06',0,NULL,NULL,NULL,'32d00137-fe52-4596-ab79-e8c9c9e54515',1),
(4,'Patient Started ART but with no documented ART Regimen','select * from patient p \r\nwhere p.patient_id in (select distinct person_id from obs b join encounter e on e.encounter_id = b.encounter_id\r\nwhere b.concept_id = 159599) and p.patient_id not in (select distinct person_id from obs b join encounter e on e.encounter_id = b.encounter_id\r\nwhere e.encounter_type = 13 and b.concept_id in (164506,164513,165702,164507,164514,165703)) and p.voided is null','Started ART but no documented ART Regimen',1,'org.openmrs.module.patientflags.evaluator.SQLFlagEvaluator',NULL,1,'2019-09-27 09:48:38',1,'2019-11-06 20:59:25',0,NULL,NULL,NULL,'8c9cd66c-05ae-4601-8dfa-92df7a18e798',1),
(5,'No Documented Weight in Last Clinical Visit','select distinct p.patient_id, MAX(e.encounter_datetime),  \r\nGROUP_CONCAT(DISTINCT(o.concept_id) SEPARATOR '','') AS concepts \r\nfrom patient p \r\njoin encounter e on e.patient_id = p.patient_id and e.encounter_type = 12\r\njoin obs o on o.encounter_id = e.encounter_id\r\nwhere e.encounter_datetime between date_add(now(), interval -6 month) and now()\r\ngroup by p.patient_id\r\nHAVING FIND_IN_SET(''5089'', GROUP_CONCAT((o.concept_id) SEPARATOR '','')) = 0','No Documented Weight in Last Clinical Visit',1,'org.openmrs.module.patientflags.evaluator.SQLFlagEvaluator',NULL,1,'2019-09-27 09:49:15',1,'2020-07-15 14:55:10',0,NULL,NULL,NULL,'4a0d0590-5774-4386-aea3-5f13ed8d1ae7',1),
(6,'Ped Patient without Last MUAC','select distinct p.patient_id, MAX(e.encounter_datetime),\r\nGROUP_CONCAT(DISTINCT(o.concept_id) SEPARATOR '','') AS concepts \r\nfrom patient p \r\njoin person pe on pe.person_id = p.patient_id\r\njoin encounter e on e.patient_id = p.patient_id and e.encounter_type = 12\r\njoin obs o on o.encounter_id = e.encounter_id\r\nwhere e.encounter_datetime between date_add(now(), interval -6 month) and now() \r\nand datediff(e.encounter_datetime,pe.birthdate)/365 <= 5\r\ngroup by p.patient_id\r\nHAVING FIND_IN_SET(''165935'', GROUP_CONCAT((o.concept_id) SEPARATOR '','')) = 0 OR\r\n	   FIND_IN_SET(''165243'', GROUP_CONCAT((o.concept_id) SEPARATOR '','')) = 0','No Documented MUAC in Last Visit',1,'org.openmrs.module.patientflags.evaluator.SQLFlagEvaluator',NULL,1,'2019-09-27 09:49:58',1,'2020-07-15 14:56:28',0,NULL,NULL,NULL,'abc9e1a2-acd5-49ae-a79e-ea08137e88e3',1),
(7,'Have no Documented WHO in Last Clinical Visit','select distinct p.patient_id, MAX(e.encounter_datetime),  \r\nGROUP_CONCAT(DISTINCT(o.concept_id) SEPARATOR '','') AS concepts \r\nfrom patient p \r\njoin encounter e on e.patient_id = p.patient_id and e.encounter_type = 12\r\njoin obs o on o.encounter_id = e.encounter_id\r\nwhere e.encounter_datetime between date_add(now(), interval -6 month) and now()\r\ngroup by p.patient_id\r\nHAVING FIND_IN_SET(''5356'', GROUP_CONCAT((o.concept_id) SEPARATOR '','')) = 0','Have no Documented WHO in Last Clinical Visit',1,'org.openmrs.module.patientflags.evaluator.SQLFlagEvaluator',NULL,1,'2019-09-27 09:52:14',1,'2020-07-15 14:54:51',0,NULL,NULL,NULL,'f0c645e9-f1cd-4546-9476-7291614cf619',1),
(8,'Patient with no documented TB Status in last clinical visit','select distinct p.patient_id, MAX(e.encounter_datetime),  \r\nGROUP_CONCAT(DISTINCT(o.concept_id) SEPARATOR '','') AS concepts \r\nfrom patient p \r\njoin encounter e on e.patient_id = p.patient_id and e.encounter_type = 12\r\njoin obs o on o.encounter_id = e.encounter_id\r\nwhere e.encounter_datetime between date_add(now(), interval -6 month) and now()\r\ngroup by p.patient_id\r\nHAVING FIND_IN_SET(''1659'', GROUP_CONCAT((o.concept_id) SEPARATOR '','')) = 0','Patient with no documented TB Status in last clinical visit',1,'org.openmrs.module.patientflags.evaluator.SQLFlagEvaluator',NULL,1,'2019-09-27 09:54:07',1,'2020-07-15 14:55:47',0,NULL,NULL,NULL,'64dc1a09-7ce0-4175-97e4-93b5ed08b936',1),
(9,'Dead without documented date of death','select p.patient_id from patient p join obs b on p.patient_id = b.person_id where patient_id in\r\n(select b.person_id patient_id from obs b where b.concept_id = 165470 and b.value_coded = 165889)\r\nand p.patient_id in \r\n(select bb.person_id as patient_id from obs bb where bb.concept_id = 165469 and bb.value_datetime is null ) \r\ngroup by p.patient_id;','Recorded as Dead Without Documented Date of Death',1,'org.openmrs.module.patientflags.evaluator.SQLFlagEvaluator',NULL,1,'2019-09-27 09:55:54',1,'2020-07-15 14:54:26',0,NULL,NULL,NULL,'5282bb1a-3f97-4021-aeab-7eff03ef4c4c',1),
(10,'Patient with regimen but no drug refill duration','select p.patient_id, max(e.encounter_datetime) ,\r\n(select max(obs_datetime) from obs where person_id = p.patient_id  and concept_id in (164506, 164513,165702,164507,164514,165703) limit 1 ) as lastRegimen, \r\n(select max(obs_datetime) from obs where person_id = p.patient_id  and concept_id = 159368 limit 1) as lastDuration\r\nfrom patient p \r\njoin encounter e on p.patient_id = e.patient_id and e.encounter_type = 14\r\ngroup by p.patient_id\r\nhaving lastDuration is null and lastRegimen is not null','Patient with regimen but no drug refill duration',1,'org.openmrs.module.patientflags.evaluator.SQLFlagEvaluator',NULL,1,'2019-09-27 11:39:21',1,'2020-07-15 14:55:57',0,NULL,NULL,NULL,'a20784cb-3587-4d13-91c7-cc0058ef92b7',1),
(11,'Patient without documented VL in last 12 months','select p.patient_id, max(e.encounter_datetime), e.encounter_type,\r\n(select TIMESTAMPDIFF(month,max(value_datetime),curdate())  from obs where person_id = p.patient_id \r\nand concept_id in (159951) limit 1) as diffsample \r\nfrom patient p \r\njoin encounter e on p.patient_id = e.patient_id and e.encounter_type = 11\r\ngroup by p.patient_id\r\nhaving diffsample >= 12','Have No Documented VL in Last 12 Months',1,'org.openmrs.module.patientflags.evaluator.SQLFlagEvaluator',NULL,1,'2019-09-27 11:45:26',1,'2020-07-15 14:56:20',0,NULL,NULL,NULL,'0982b200-0075-4f05-92fe-3837a11c6b73',1),
(12,'Patient with viral load without test date','select p.patient_id\r\nfrom patient p \r\njoin encounter e on p.patient_id = e.patient_id and e.encounter_type = 11\r\nwhere p.patient_id in \r\n(select person_id as patient_id  from obs where person_id = p.patient_id  and concept_id in (856) group by patient_id order by obs_datetime desc )\r\nand p.patient_id not in\r\n(select  person_id as patient_id from obs where  concept_id = 159951 group by patient_id order by obs_datetime desc ) \r\ngroup by p.patient_id','Have Viral Load Without a Result Test Date',1,'org.openmrs.module.patientflags.evaluator.SQLFlagEvaluator',NULL,1,'2019-09-28 08:43:06',1,'2020-07-15 14:56:09',0,NULL,NULL,NULL,'e4188c1d-56d8-4eb0-92a9-15d224a94ce2',1),
(13,'Patient with CD4 Ordered without Result','select p.patient_id,\r\n(select value_coded  from obs where person_id = p.patient_id \r\nand concept_id in (165731) order by obs_datetime desc limit 1) as adultCD4Order,\r\n(select value_numeric  from obs where person_id = p.patient_id \r\n and concept_id = 5497 order by obs_datetime desc limit 1) as adultCD4Result,\r\n(select value_coded  from obs where person_id = p.patient_id \r\n and concept_id in (165748) order by obs_datetime desc limit 1) as pedCD4Order,\r\n(select value_numeric  from obs where person_id = p.patient_id \r\n and concept_id in (730) order by obs_datetime desc limit 1) as pedCD4Result\r\nfrom patient p \r\njoin encounter e on p.patient_id = e.patient_id and e.encounter_type = 11\r\ngroup by p.patient_id\r\nhaving (adultCD4Order is not null and adultCD4Result is null) \r\nor pedCD4Order is not null and pedCD4Result is null','Have CD4 Ordered Without CD4 Result',1,'org.openmrs.module.patientflags.evaluator.SQLFlagEvaluator',NULL,1,'2019-09-28 09:01:46',1,'2020-07-15 14:55:38',0,NULL,NULL,NULL,'5c1fc5fe-7b19-4937-a893-bcbba4202b9d',1),
(14,'Inactive Patient with no documented exit reason','select p.patient_id,\r\n(select (TIMESTAMPDIFF(day,value_datetime,curdate())) from obs where person_id = p.patient_id  \r\nand concept_id in (164506, 164513,165702,164507,164514,165703) order by obs_datetime desc limit 1) as lastRegimenDiff, \r\n(select value_numeric from obs where person_id = p.patient_id and concept_id = 159368 order by obs_datetime desc limit 1) as lastDuration,\r\n(select value_coded from obs where person_id = p.patient_id and concept_id = 165470 order by obs_datetime desc limit 1 ) as reasonTermination\r\nfrom patient p \r\njoin encounter e on p.patient_id = e.patient_id and e.encounter_type in (14,15)\r\ngroup by p.patient_id\r\nhaving (lastRegimenDiff + lastDuration) > 28 and reasonTermination is null','Inactive Patient With No Documented Exit Reason',1,'org.openmrs.module.patientflags.evaluator.SQLFlagEvaluator',NULL,1,'2019-09-28 09:24:01',1,'2020-07-15 14:55:01',0,NULL,NULL,NULL,'847b79b2-3448-4950-81d4-328b0af2044d',1)/0xd