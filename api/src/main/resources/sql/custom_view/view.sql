CREATE OR REPLACE VIEW `concept_view` AS select `c`.`concept_id` AS `concept_id`,`cn`.`name` AS `NAME`,`cn`.`locale_preferred` AS `locale_preferred` from (`concept_name` `cn` join `concept` `c` on((`c`.`concept_id` = `cn`.`concept_id`))) where ((`cn`.`locale_preferred` = 1) and (`cn`.`locale` = 'en'))/0xd
CREATE OR REPLACE VIEW `encounter_type_view` AS select `e`.`encounter_type` AS `EncounterTypeId`,(select `et`.`name` from `encounter_type` `et` where (`et`.`encounter_type_id` = `e`.`encounter_type`)) AS `EncounterType`,count(`e`.`encounter_type`) AS `NumberOfEncounters` from `encounter` `e` group by `e`.`encounter_type`/0xd
CREATE OR REPLACE VIEW `obs_view` AS select `obs`.`person_id` AS `person_id`,`obs`.`concept_id` AS `concept_id`,(select `encounter`.`encounter_datetime` from `encounter` where (`encounter`.`encounter_id` = `obs`.`encounter_id`) limit 1) AS `encounter_datetime`,(select `concept_view`.`NAME` from `concept_view` where (`concept_view`.`concept_id` = `obs`.`concept_id`) limit 1) AS `question`,(select `concept_view`.`NAME` from `concept_view` where (`concept_view`.`concept_id` = `obs`.`value_coded`) limit 1) AS `answer`,`obs`.`value_coded` AS `value_coded` from `obs`/0xd
CREATE OR REPLACE VIEW `patient_line_list` AS select (select count(`encounter`.`encounter_type`) from `encounter` where ((`encounter`.`encounter_type` = 13) and (`encounter`.`patient_id` = `p`.`patient_id`))) AS `encounterTypePhamacy`,(select count(`encounter`.`encounter_type`) from `encounter` where ((`encounter`.`encounter_type` = 11) and (`encounter`.`patient_id` = `p`.`patient_id`))) AS `encounterTypeLab`,(select concat(`pn`.`given_name`,' ',`pn`.`family_name`) from `person_name` `pn` where ((`pn`.`person_id` = `p`.`patient_id`) and (`pn`.`preferred` = 1)) limit 1) AS `personName`,(select `pid`.`identifier` from `patient_identifier` `pid` where ((`pid`.`patient_id` = `p`.`patient_id`) and (`pid`.`preferred` = 1)) limit 1) AS `identifier`,(select `fe`.`encounter_datetime` from `encounter` `fe` where (`fe`.`patient_id` = `p`.`patient_id`) order by `fe`.`encounter_datetime` limit 1) AS `dateOfFirstEncounter`,(select `obs`.`answer` from `obs_view` `obs` where ((`obs`.`person_id` = `p`.`patient_id`) and (`obs`.`concept_id` = 165724)) order by (`obs`.`encounter_datetime` and (`obs`.`encounter_datetime` is not null)) limit 1) AS `firstDocumentedRegimen`,(select `obs`.`answer` from `obs_view` `obs` where ((`obs`.`person_id` = `p`.`patient_id`) and (`obs`.`concept_id` = 165724)) order by (`obs`.`encounter_datetime` and (`obs`.`encounter_datetime` is not null)) desc limit 1) AS `LastdocumentedRegimen`,(select `le`.`encounter_datetime` from `encounter` `le` where (`le`.`patient_id` = `p`.`patient_id`) order by `le`.`encounter_datetime` desc limit 1) AS `dateOfLastEncounter` from `patient` `p`/0xd